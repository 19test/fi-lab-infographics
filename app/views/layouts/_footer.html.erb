<!-- replace_contents 'footer' -->

<footer>
<div>
  <%= Date.today.year %> 
  Â© 
  <%= link_to 'FI-WARE', 'http://fi-ware.eu/' %> & <%= link_to 'FI-OPS', 'http://fi-xifi.eu/fi-ops' %>. 
  The use of FI-LAB services is subject to the acceptance of the
  <a href="http://forge.fi-ware.eu/plugins/mediawiki/wiki/fiware/index.php/FI-LAB_Terms_and_Conditions"> 
    Terms and Conditions
  </a>
  and 
  <a href="http://forge.fi-ware.eu/plugins/mediawiki/wiki/fiware/index.php/FI-LAB_Personal_Data_Protection_Policy">
    Personal Data Protection Policy
  </a>
</div>
</footer>

<% if @attributes != nil then %>
<!-- #################################################################################### -->

<!-- ===== init ===== -->
<script type="text/javascript">
	$(document).ready(function() 
	{
		/** =================================================================
		*  Map
		**/
		
		$('#world-map').vectorMap({
		map: 'world_mill_en',
			backgroundColor: 'white',
			selectedRegions: /*['IT','PL','US','ES','GB']*/[
					<%
					  @attributes.each do |key,value|
					    if value["location"] != "" then
					    %>
					      '<%=value["location"]%>', 
					    <%
					    end
					  end
					%>],
			regionStyle: {
							  initial: {
							    fill: '#999999',
							    "fill-opacity": 1,
							    stroke: 'none',
							    "stroke-width": 0,
							    "stroke-opacity": 1
							  },
							  hover: {
							    "fill-opacity": 0.8
							  },
							  selected: {
								fill: 'orange'
							  },
							  selectedHover: {
							  }
						}

		});
		
		$('#world-map').vectorMap('set', 'focus', 4.3, 0.5, 0.3);
		
		$('#world-map-cpu').vectorMap({
		map: 'world_mill_en',
			regionStyle: {
				  initial: {
				    fill: '#ffffff',
				    "fill-opacity": 1,
				    stroke: 'none',
				    "stroke-width": 0,
				    "stroke-opacity": 1
				  },
				  hover: {
				    "fill-opacity": 0.8
				  },
				  selected: {
					fill: 'orange'
				  },
				  selectedHover: {
				  }
			},
			markerStyle: {
		      initial: {
			fill: '#ff9900',
			stroke: '#383f47'
		      }
		    },
			series: {
						regions: [{
									values: {
									<%
									  @attributes.each do |key,value|
									    if value["location"] != "" then
									    %>
									      "<%=value["location"]%>": <%=value["coreTot"].to_i%>, 
									    <%
									    end
									  end
									%>
									},
								scale: ['#C8EEFF', '#0071A4'],
								normalizeFunction: 'polynomial'
						}]
			},
			markers: [
		      <%
			@attributes.each do |key,value|
			  if value["latitude"] != "" && value["longitude"] != "" then
			  %>
			    {latLng: [ <%=value["latitude"].to_f%>,<%=value["longitude"].to_f%> ], name: '<%=key%> (<%=value["coreTot"].to_i%> core)'}, 
			  <%
			  end
			end
		      %>
		      /*{latLng: [41.90, 12.45], name: 'Vatican City (3 Gb)'},
		      {latLng: [43.73, 7.41], name: 'Monaco (1 Gb)'},
		      {latLng: [47.14, 9.52], name: 'Liechtenstein (6 Gb)'},
		      {latLng: [35.88, 14.5], name: 'Malta (3 Gb)'},
		      {latLng: [42.5, 1.51], name: 'Andorra (1 Gb)'}*/
			]

		});
		
		$('#world-map-cpu').vectorMap('set', 'focus', 4.3, 0.5, 0.3);
		
		$('#world-map-ram').vectorMap({
		map: 'world_mill_en',
			regionStyle: {
				  initial: {
				    fill: '#ffffff',
				    "fill-opacity": 1,
				    stroke: 'none',
				    "stroke-width": 0,
				    "stroke-opacity": 1
				  },
				  hover: {
				    "fill-opacity": 0.8
				  },
				  selected: {
					fill: 'orange'
				  },
				  selectedHover: {
				  }
			},
			markerStyle: {
		      initial: {
			fill: '#ff9900',
			stroke: '#383f47'
		      }
		    },
			series: {
						regions: [{
									values: {
									<%
									  @attributes.each do |key,value|
									    if value["location"] != "" then
									    %>
									      "<%=value["location"]%>": <%=value["ramTot"].to_i%>, 
									    <%
									    end
									  end
									%>
									},
								scale: ['#C8EEFF', '#0071A4'],
								normalizeFunction: 'polynomial'
						}]
			},
			markers: [
		      <%
			@attributes.each do |key,value|
			 if value["latitude"] != "" && value["longitude"] != "" then
			  %>
			    {latLng: [ <%=value["latitude"].to_f%>,<%=value["longitude"].to_f%> ], name: '<%=key%> (<%=value["ramTot"].to_i%> Mb)'}, 
			  <%
			 end
			end
		      %>
		      /*{latLng: [41.90, 12.45], name: 'Vatican City (3 Gb)'},
		      {latLng: [43.73, 7.41], name: 'Monaco (1 Gb)'},
		      {latLng: [47.14, 9.52], name: 'Liechtenstein (6 Gb)'},
		      {latLng: [35.88, 14.5], name: 'Malta (3 Gb)'},
		      {latLng: [42.5, 1.51], name: 'Andorra (1 Gb)'}*/
			]

		});
		
		$('#world-map-ram').vectorMap('set', 'focus', 4.3, 0.5, 0.3);
		
		$('#world-map-disk').vectorMap({
		map: 'world_mill_en',
			regionStyle: {
				  initial: {
				    fill: '#ffffff',
				    "fill-opacity": 1,
				    stroke: 'none',
				    "stroke-width": 0,
				    "stroke-opacity": 1
				  },
				  hover: {
				    "fill-opacity": 0.8
				  },
				  selected: {
					fill: 'orange'
				  },
				  selectedHover: {
				  }
			},
			markerStyle: {
		      initial: {
			fill: '#ff9900',
			stroke: '#383f47'
		      }
		    },	series: {
						regions: [{
									values: {
									<%
									  @attributes.each do |key,value|
									    if value["location"] != "" then
									    %>
									      "<%=value["location"]%>": <%=value["hdTot"].to_i%>, 
									    <%
									    end
									  end
									%>
									},
								scale: ['#C8EEFF', '#0071A4'],
								normalizeFunction: 'polynomial'
						}]
			},
			markers: [
		      <%
			@attributes.each do |key,value|
			  if value["latitude"] != "" && value["longitude"] != "" then
			  %>
			    {latLng: [ <%=value["latitude"].to_f%>,<%=value["longitude"].to_f%> ], name: '<%=key%> (<%=value["hdTot"].to_i%> Gb)'}, 
			  <%
			  end
			end
		      %>
		      /*{latLng: [41.90, 12.45], name: 'Vatican City (3 Gb)'},
		      {latLng: [43.73, 7.41], name: 'Monaco (1 Gb)'},
		      {latLng: [47.14, 9.52], name: 'Liechtenstein (6 Gb)'},
		      {latLng: [35.88, 14.5], name: 'Malta (3 Gb)'},
		      {latLng: [42.5, 1.51], name: 'Andorra (1 Gb)'}*/
			]

		});
		
		$('#world-map-disk').vectorMap('set', 'focus', 4.3, 0.5, 0.3);
		
		$('#world-map-vm').vectorMap({
		map: 'world_mill_en',
			regionStyle: {
							  initial: {
							    fill: '#ffffff',
							    "fill-opacity": 1,
							    stroke: 'none',
							    "stroke-width": 0,
							    "stroke-opacity": 1
							  },
							  hover: {
							    "fill-opacity": 0.8
							  },
							  selected: {
								fill: 'orange'
							  },
							  selectedHover: {
							  }
						},
			markerStyle: {
		      initial: {
			fill: '#ff9900',
			stroke: '#383f47'
		      }
		    },	series: {
						regions: [{
									values: {
									<%
									  @attributes.each do |key,value|
									    if value["location"] != "" then
									    %>
									      "<%=value["location"]%>": <%=value["vmTot"].to_i%>, 
									    <%
									    end
									  end
									%>
									},
								scale: ['#C8EEFF', '#0071A4'],
								normalizeFunction: 'polynomial'
						}]
			},
			markers: [
		      <%
			@attributes.each do |key,value|
			  if value["latitude"] != "" && value["longitude"] != "" then
			  %>
			    {latLng: [ <%=value["latitude"].to_f%>,<%=value["longitude"].to_f%> ], name: '<%=key%> (<%=value["vmTot"].to_i%> vm)'}, 
			  <%
			  end
			end
		      %>
		      /*{latLng: [41.90, 12.45], name: 'Vatican City (3 Gb)'},
		      {latLng: [43.73, 7.41], name: 'Monaco (1 Gb)'},
		      {latLng: [47.14, 9.52], name: 'Liechtenstein (6 Gb)'},
		      {latLng: [35.88, 14.5], name: 'Malta (3 Gb)'},
		      {latLng: [42.5, 1.51], name: 'Andorra (1 Gb)'}*/
			]

		});
		
		$('#world-map-vm').vectorMap('set', 'focus', 4.3, 0.5, 0.3);
		
		/*$('#world-map-ge').vectorMap({
		map: 'world_mill_en',
			regionStyle: {
							  initial: {
							    fill: '#ffffff',
							    "fill-opacity": 1,
							    stroke: 'none',
							    "stroke-width": 0,
							    "stroke-opacity": 1
							  },
							  hover: {
							    "fill-opacity": 0.8
							  },
							  selected: {
								fill: 'orange'
							  },
							  selectedHover: {
							  }
						}

		});*/
		
		/** ================================================================= 
		*	Accordion Effect
		*/
		$('.accordionPanel').not('.leaveOpen').hide();
		$('.accordionTitle').click( function()
		{
			var $this = $(this);
			$this.next('.accordionPanel').slideToggle(function()
			{
				if( $this.hasClass('closeme' ) )
				{
					$this.removeClass('closeme' );
					$this.addClass('openme' );
				}
				else
				{
					$this.removeClass('openme' );
					$this.addClass('closeme' );
				}
			});
		});
		$('.accordionTitle').hover( 
			function()
			{
				$(this).addClass('hovered');
			},
			function()
			{
				$(this).removeClass('hovered');
			}
		);

		/** ================================================================= **/
// 		$. ajax (
// 			  {
// 			    type: "GET",
// 			    dataType: 'json',
// 			    url: "http://192.168.59.2:1337/region",
// 			    data: data,
// 			    success: function (data)
// 			    {
// 				  console.log(data)
// 			    }
// 			}
// 		);
		
// 		$.ajax({
// 			url: "http://192.168.59.2:1337/region",
// 			cache: false
// 			})
// 			.done(function( html ) {
// 			  console.log(html);
// 			});
			
// 		var request = $.ajax({
// 				      url: "http://192.168.59.2:1337/region",
// 				      type: "GET",
// 				      data: {},
// 				      dataType: "json"
// 		});
// 		
// 		request.done(function( msg ) {
// 		  console.log("AAAAAAAAAAA");
// 		  console.log(msg);
// 		});
// 		
// 		request.fail(function( jqXHR, textStatus ) {
// 							    alert( "Request failed: " + textStatus+jqXHR );
// 							    });
		
// 		$.ajax({
// 			dataType: "json",
// 			url: url,
// 			data: data,
// 			success: success
// 		});

// 		setInterval('window.location.reload()', 60000);
    
	});
</script>
<% end %>